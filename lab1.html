<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>02ea2930540d42819a8a88c86d7f5b72</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown">
<h1 align="center">Practical Lab 1</h1>
</div>
<div class="cell markdown">
<ul>
<li>Name: Abdul Bari Mohammed</li>
<li>ID: 8985877</li>
</ul>
</div>
<section id="section" class="cell markdown">
<h2></h2>
<p>Goal: My target is to predict the average price of houses by
selecting the best model from using 3 factors such as median income,
population, number of households vs median house value.</p>
</section>
<div class="cell code" data-execution_count="114">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&quot;housing.csv&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="60">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Index([&#39;longitude&#39;, &#39;latitude&#39;, &#39;housing_median_age&#39;, &#39;total_rooms&#39;,
       &#39;total_bedrooms&#39;, &#39;population&#39;, &#39;households&#39;, &#39;median_income&#39;,
       &#39;median_house_value&#39;, &#39;ocean_proximity&#39;],
      dtype=&#39;object&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="61">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># got all the statistics of the dataset.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>housing_median_age</th>
      <th>total_rooms</th>
      <th>total_bedrooms</th>
      <th>population</th>
      <th>households</th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20433.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
      <td>20640.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-119.569704</td>
      <td>35.631861</td>
      <td>28.639486</td>
      <td>2635.763081</td>
      <td>537.870553</td>
      <td>1425.476744</td>
      <td>499.539680</td>
      <td>3.870671</td>
      <td>206855.816909</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.003532</td>
      <td>2.135952</td>
      <td>12.585558</td>
      <td>2181.615252</td>
      <td>421.385070</td>
      <td>1132.462122</td>
      <td>382.329753</td>
      <td>1.899822</td>
      <td>115395.615874</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-124.350000</td>
      <td>32.540000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>0.499900</td>
      <td>14999.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-121.800000</td>
      <td>33.930000</td>
      <td>18.000000</td>
      <td>1447.750000</td>
      <td>296.000000</td>
      <td>787.000000</td>
      <td>280.000000</td>
      <td>2.563400</td>
      <td>119600.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-118.490000</td>
      <td>34.260000</td>
      <td>29.000000</td>
      <td>2127.000000</td>
      <td>435.000000</td>
      <td>1166.000000</td>
      <td>409.000000</td>
      <td>3.534800</td>
      <td>179700.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>-118.010000</td>
      <td>37.710000</td>
      <td>37.000000</td>
      <td>3148.000000</td>
      <td>647.000000</td>
      <td>1725.000000</td>
      <td>605.000000</td>
      <td>4.743250</td>
      <td>264725.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>-114.310000</td>
      <td>41.950000</td>
      <td>52.000000</td>
      <td>39320.000000</td>
      <td>6445.000000</td>
      <td>35682.000000</td>
      <td>6082.000000</td>
      <td>15.000100</td>
      <td>500001.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="62">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;median_income&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Median Income vs Median House Value&#39;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/ed0c34a1bbe22b5f2968f1d51c31a27809ad54dd.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>by comparing average house value with average income we can clearly
see that they both are increasing together it means they are corelated
to each other. moreover, we can also see some outliers above the average
income of 6 that is, high value of the houses exists even with the low
income.</p>
</div>
<div class="cell code" data-execution_count="63">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;population&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Population vs Median House Value&#39;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/f3ad6d59aa1cdec189b1d043bc7396edee0c5465.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>by comparing average house value with the population we saw that
there is no correlation between the high population and high median
house values.</p>
</div>
<div class="cell code" data-execution_count="64">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;households&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Number of Households vs Median House Value&#39;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/0dc7329281660d10047bb775fbc049be68508521.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>by comparing households with the average house value we can see that
there are fewer houses with the high median house values and most of the
houses have lower prices.</p>
</div>
<section id="description-of-the-variables" class="cell markdown">
<h1>Description of the variables</h1>
</section>
<div class="cell markdown">
<ul>
<li>Median house value: This is the average (middle) value of house
prices, it reflects the central tendancy of home prices and its range is
from 0 to 500000</li>
<li>Median income: this is the average income of the people living in
california, this also reflects central tendency of income of the
population and its range is from 0 to 15</li>
<li>population: This is the total number of population from the dataset
which ranges from 0 to 35000</li>
<li>Number of households: This is the total count of houses from the
dataset, ranges from 0 to 6000</li>
</ul>
</div>
<div class="cell markdown">
<h1 align="center">Univariate Linear Regression Model</h1>
</div>
<div class="cell code" data-execution_count="120">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>X_income <span class="op">=</span> df[[<span class="st">&#39;median_income&#39;</span>]]  </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>]  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_income, y)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>y_pred_income <span class="op">=</span> model.predict(X_income)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>mse_income <span class="op">=</span> mean_squared_error(y, y_pred_income)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>mae_income <span class="op">=</span> mean_absolute_error(y, y_pred_income)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>intercept_income, slope_income <span class="op">=</span> model.intercept_, model.coef_[<span class="dv">0</span>]</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Intercept: </span><span class="sc">{</span>intercept_income<span class="sc">}</span><span class="ss">, Slope: </span><span class="sc">{</span>slope_income<span class="sc">}</span><span class="ss">, MSE: </span><span class="sc">{</span>mse_income<span class="sc">}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae_income<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intercept: 45085.5767032679, Slope: 41793.849201896286, MSE: 7011311502.929527, MAE: 62625.9337911434
</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li>Intercept: 45085.5767032679 this is the predicted average value of
houses by taking average income as 0 by default which is unrealistic but
it will change according to the value of slope.</li>
<li>Slope: 41793.849201896286 this is the average increase in prices of
house per every unit increase of income so this value clearly shows the
strong relationship between average income and average house
values.</li>
<li>Mean Squared Error(MSE): 7011311502.929527 as the value is of mse is
higher the prediction of the model will be not accurate. this higher
value clearly suggests that model needs to be more improved.</li>
<li>Mean Absolute Error(MAE): 62625.9337911434 this is average absolute
difference between the predicted values and the actual values so as this
value is also high so, models predition may not be very accurate.</li>
</ul>
</div>
<div class="cell code" data-execution_count="116">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>X_population <span class="op">=</span> df[[<span class="st">&#39;population&#39;</span>]]  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>] </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_population, y)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>y_pred_population <span class="op">=</span> model.predict(X_population)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>mse_population <span class="op">=</span> mean_squared_error(y, y_pred_population)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>mae_population <span class="op">=</span> mean_absolute_error(y, y_pred_population)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>intercept_population, slope_population <span class="op">=</span> model.intercept_, model.coef_[<span class="dv">0</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Intercept: </span><span class="sc">{</span>intercept_population<span class="sc">}</span><span class="ss">, Slope: </span><span class="sc">{</span>slope_population<span class="sc">}</span><span class="ss">, MSE: </span><span class="sc">{</span>mse_population<span class="sc">}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae_population<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intercept: 210436.26207627333, Slope: -2.511752774615085, MSE: 13307412412.389355, MAE: 91153.82009473183
</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li>Slope: -2.511752774615085 this value clearly shows the negative
relationship between average house value and population it means as the
population increases the average house values are predicted to
decrease.</li>
<li>MSE: 13307412412.389355 This is again the high value which means
model needs to be improved.</li>
<li>MAE: 91153.82009473183 Mean Absolute Error is also high which
clearly shows model may not predict the accurate value.</li>
</ul>
</div>
<div class="cell code" data-execution_count="117">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>X_households <span class="op">=</span> df[[<span class="st">&#39;households&#39;</span>]]  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>]  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_households, y)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>y_pred_households <span class="op">=</span> model.predict(X_households)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>mse_households <span class="op">=</span> mean_squared_error(y, y_pred_households)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>mae_households <span class="op">=</span> mean_absolute_error(y, y_pred_households)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>intercept_households, slope_households <span class="op">=</span> model.intercept_, model.coef_[<span class="dv">0</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Intercept: </span><span class="sc">{</span>intercept_households<span class="sc">}</span><span class="ss">, Slope:</span><span class="sc">{</span>intercept_households<span class="sc">}</span><span class="ss">, MSE: </span><span class="sc">{</span>mse_households<span class="sc">}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae_households<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intercept: 196928.57716233088, Slope:196928.57716233088, MSE: 13257776904.728533, MAE: 90802.74324318448
</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li>Slope: 19.872775155643875 this positive value clearly shows the
price of the house will increase as the houses increase.</li>
<li>MSE: 13257776904.728533 this is also the high value which means
model needs to be improved.</li>
</ul>
</div>
<div class="cell code" data-execution_count="118">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Model&#39;</span>: [<span class="st">&#39;Median Income&#39;</span>, <span class="st">&#39;Population&#39;</span>, <span class="st">&#39;Number of Households&#39;</span>],</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Intercept&#39;</span>: [intercept_income, intercept_population, intercept_households],</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Slope&#39;</span>: [slope_income, slope_population, slope_households],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;MSE&#39;</span>: [mse_income, mse_population, mse_households],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;MAE&#39;</span>: [mae_income, mae_population, mae_households]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_results)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                  Model      Intercept         Slope           MSE  \
0         Median Income   45085.576703  41793.849202  7.011312e+09   
1            Population  210436.262076     -2.511753  1.330741e+10   
2  Number of Households  196928.577162     19.872775  1.325778e+10   

            MAE  
0  62625.933791  
1  91153.820095  
2  90802.743243  
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="121">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;median_income&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X_income, model.predict(X_income), color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="ss">f&quot;Line: y=</span><span class="sc">{</span>intercept_income<span class="sc">:.2f}</span><span class="ss">+</span><span class="sc">{</span>slope_income<span class="sc">:.2f}</span><span class="ss">*x&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Regression Line: Median Income vs Median House Value&quot;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">5</span>, <span class="dv">400000</span>, <span class="ss">f&#39;Intercept: </span><span class="sc">{</span>intercept_income<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Slope: </span><span class="sc">{</span>slope_income<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MSE: </span><span class="sc">{</span>mse_income<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MAE: </span><span class="sc">{</span>mae_income<span class="sc">:.2f}</span><span class="ss">&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/6f1185fa396b7cdae0cb128ad46ca7a9a04154d9.png" /></p>
</div>
</div>
<div class="cell code">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;population&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X_population, model.predict(X_population), color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="ss">f&quot;Line: y=</span><span class="sc">{</span>intercept_population<span class="sc">:.2f}</span><span class="ss">+</span><span class="sc">{</span>slope_population<span class="sc">:.2f}</span><span class="ss">*x&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Regression Line: population vs Median House Value&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">5</span>, <span class="dv">400000</span>, <span class="ss">f&#39;Intercept: </span><span class="sc">{</span>intercept_population<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Slope: </span><span class="sc">{</span>slope_population<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MSE: </span><span class="sc">{</span>mse_population<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MAE: </span><span class="sc">{</span>mae_population<span class="sc">:.2f}</span><span class="ss">&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/4c18ec95b11d1b602050446c92af46568f23d6f4.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="102">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;households&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X_households, model.predict(X_households), color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="ss">f&quot;Line: y=</span><span class="sc">{</span>intercept_households<span class="sc">:.2f}</span><span class="ss">+</span><span class="sc">{</span>slope_households<span class="sc">:.2f}</span><span class="ss">*x&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Regression Line: households vs Median House Value&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">5</span>, <span class="dv">400000</span>, <span class="ss">f&#39;Intercept: </span><span class="sc">{</span>intercept_households<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Slope: </span><span class="sc">{</span>slope_households<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MSE: </span><span class="sc">{</span>mse_households<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MAE: </span><span class="sc">{</span>mae_households<span class="sc">:.2f}</span><span class="ss">&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/48b3c0d6b517917e484b21f894afb8234d0a7d48.png" /></p>
</div>
</div>
<div class="cell markdown">
<h1 align="center">Improvement of model</h1>
</div>
<div class="cell markdown">
<p>I will try to imrpove the model by removing outliers from the dataset
by using Z - score method.</p>
</div>
<div class="cell code" data-execution_count="130">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>].quantile(<span class="fl">0.25</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Q3 <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>].quantile(<span class="fl">0.75</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[(df[<span class="st">&#39;median_house_value&#39;</span>] <span class="op">&gt;=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR) <span class="op">&amp;</span> (df[<span class="st">&#39;median_house_value&#39;</span>] <span class="op">&lt;=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR)]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="135">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>X_income <span class="op">=</span> df[[<span class="st">&#39;median_income&#39;</span>]]  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>]  </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_income, y)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>y_pred_income <span class="op">=</span> model.predict(X_income)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>mse_income <span class="op">=</span> mean_squared_error(y, y_pred_income)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>mae_income <span class="op">=</span> mean_absolute_error(y, y_pred_income)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>intercept_income, slope_income <span class="op">=</span> model.intercept_, model.coef_[<span class="dv">0</span>]</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Intercept: </span><span class="sc">{</span>intercept_income<span class="sc">}</span><span class="ss">, Slope: </span><span class="sc">{</span>slope_income<span class="sc">}</span><span class="ss">, MSE: </span><span class="sc">{</span>mse_income<span class="sc">}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae_income<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intercept: 49576.903270495764, Slope: 37538.97159049163, MSE: 4644324890.56233, MAE: 52885.408459991115
</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li>Intercept: as we can see intercept value is decreased after the
improvement it means may be outliers were affecting the baseline value
of the prices of houses.</li>
<li>Slope: slope is also decreased, it clearly means outliers were
increasing slope value.</li>
<li>MSE: mean squared error also decreased which means model is improved
than the previous, we can say the prediction of this model could be more
accurate than the previous one.</li>
<li>MAE: the value of mean absolute error also decreased which means the
predictions of model for prices of houses can be more closer to actual
values of the houses on average.</li>
</ul>
</div>
<div class="cell code" data-execution_count="137">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>X_population <span class="op">=</span> df[[<span class="st">&#39;population&#39;</span>]]  </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>] </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_population, y)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>y_pred_population <span class="op">=</span> model.predict(X_population)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>mse_population <span class="op">=</span> mean_squared_error(y, y_pred_population)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>mae_population <span class="op">=</span> mean_absolute_error(y, y_pred_population)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>intercept_population, slope_population <span class="op">=</span> model.intercept_, model.coef_[<span class="dv">0</span>]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Intercept: </span><span class="sc">{</span>intercept_population<span class="sc">}</span><span class="ss">, Slope: </span><span class="sc">{</span>slope_population<span class="sc">}</span><span class="ss">, MSE: </span><span class="sc">{</span>mse_population<span class="sc">}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae_population<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intercept: 182318.11296920126, Slope: 2.2102007931983807, MSE: 7861350548.689875, MAE: 72261.96006053129
</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li>Slope: the value of the slope now is positive which shows as the
population increases the average price of house will also increases
which is logically correct.</li>
</ul>
</div>
<div class="cell code" data-execution_count="144">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>X_households <span class="op">=</span> df[[<span class="st">&#39;households&#39;</span>]]  </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;median_house_value&#39;</span>]  </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>model.fit(X_households, y)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>y_pred_households <span class="op">=</span> model.predict(X_households)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>mse_households <span class="op">=</span> mean_squared_error(y, y_pred_households)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>mae_households <span class="op">=</span> mean_absolute_error(y, y_pred_households)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>intercept_households, slope_households <span class="op">=</span> model.intercept_, model.coef_[<span class="dv">0</span>]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Intercept: </span><span class="sc">{</span>intercept_households<span class="sc">}</span><span class="ss">, Slope: </span><span class="sc">{</span>slope_households<span class="sc">}</span><span class="ss">, MSE: </span><span class="sc">{</span>mse_households<span class="sc">}</span><span class="ss">, MAE: </span><span class="sc">{</span>mae_households<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intercept: 173195.64638978575, Slope: 24.583962015685078, MSE: 7778561408.090781, MAE: 71788.07138623866
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="136">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;median_income&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X_income, model.predict(X_income), color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="ss">f&quot;Line: y=</span><span class="sc">{</span>intercept_income<span class="sc">:.2f}</span><span class="ss">+</span><span class="sc">{</span>slope_income<span class="sc">:.2f}</span><span class="ss">*x&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Regression Line: Median Income vs Median House Value&quot;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">5</span>, <span class="dv">400000</span>, <span class="ss">f&#39;Intercept: </span><span class="sc">{</span>intercept_income<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Slope: </span><span class="sc">{</span>slope_income<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MSE: </span><span class="sc">{</span>mse_income<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MAE: </span><span class="sc">{</span>mae_income<span class="sc">:.2f}</span><span class="ss">&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/2840d3301eabcbcd3bfb35fa825014022cd8939b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="138">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;population&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X_population, model.predict(X_population), color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="ss">f&quot;Line: y=</span><span class="sc">{</span>intercept_population<span class="sc">:.2f}</span><span class="ss">+</span><span class="sc">{</span>slope_population<span class="sc">:.2f}</span><span class="ss">*x&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Regression Line: population vs Median House Value&quot;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">5</span>, <span class="dv">400000</span>, <span class="ss">f&#39;Intercept: </span><span class="sc">{</span>intercept_population<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Slope: </span><span class="sc">{</span>slope_population<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MSE: </span><span class="sc">{</span>mse_population<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MAE: </span><span class="sc">{</span>mae_population<span class="sc">:.2f}</span><span class="ss">&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/c5c2abdab2735ae19a93800ec038f5ad79411c93.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="145">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;households&#39;</span>, y<span class="op">=</span><span class="st">&#39;median_house_value&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X_households, model.predict(X_households), color<span class="op">=</span><span class="st">&#39;red&#39;</span>, label<span class="op">=</span><span class="ss">f&quot;Line: y=</span><span class="sc">{</span>intercept_households<span class="sc">:.2f}</span><span class="ss">+</span><span class="sc">{</span>slope_households<span class="sc">:.2f}</span><span class="ss">*x&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Regression Line: households vs Median House Value&quot;</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">5</span>, <span class="dv">400000</span>, <span class="ss">f&#39;Intercept: </span><span class="sc">{</span>intercept_households<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">Slope: </span><span class="sc">{</span>slope_households<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MSE: </span><span class="sc">{</span>mse_households<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">MAE: </span><span class="sc">{</span>mae_households<span class="sc">:.2f}</span><span class="ss">&#39;</span>, color<span class="op">=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_86baf1dd1e444db89bb911a3cd70c685/1a402c1dc2cb7850802d3ec379f154f811adf7a6.png" /></p>
</div>
</div>
<section id="conclusion" class="cell markdown">
<h2>CONCLUSION</h2>
</section>
<div class="cell markdown">
<p>To conclude I would say considering median house value vs median
income would be the best model for predicting the house prices because
its slope value shows the stronger relationship between each other means
prices are increasing as the income is increased, moreover the value of
mean squared error and mean absolute value error are also low which
means prediction of the model will be close to accuracy. however
comparing median house value vs population and households also had lower
mae and mse but it did not had the stronger correlation which income
had.</p>
</div>
</body>
</html>
